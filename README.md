# Trivium
A Verilog implementation of the Trivium stream cipher

# 0. Overview
    0. Overview
    1. General Information
    2. Current Status
    3. Synthesizing and Testing The Core
    4. TODOs
    5. License
    6. References
	

# 1. General Information
    + This Verilog implementation of the Trivium stream cipher consists of:
        - The core components
        - A testbench that tests the top level functionality
        - A Python reference implementation for the generation of test vectors and possibly other scenarios
        - Currently a single bare-metal test for the Zynq
    + The interface of the core conforms to the AXI4LITE bus protocol
    + The hdl/src directory contains the source code of the core, whereas the testbench can be found in hdl/tb
    + The AXI-related code is located in hdl/ip and can be used to create and package the core
    + Test vectors and the python reference implementation can be found in the reference_implementation/ directory
    + A Linux driver can be found in sw/linux_driver, along with a simple Linux user-space test in sw/linux_test
    + Compiling the driver simply requires the Xilinx cross-compilation toolchain and the environment variable KDIR to point to the root of the Linux kernel build tree
    + The device tree must be updated with a node for the core - The compatible string can be found in the driver source
    + The specification of Trivium can be found in [1]
	
# 2. Current Status
    The core has successfully been synthesized, placed and routed in a design. In addition, the test coverage of
    the behavioral simulation is complete, with the core passing all tests. Also, the core was packaged
    as an AXI IP core and tested in a simple Zynq design. A few bare-metal tests were written which interface
    the core from one of the Cortex A9 cores in the PS. All tests execute successfully.
    In addition, a Linux device driver was developed for the core. A simple set of randomized tests were used
    to verify the functionality in a Linux user-space environment running on the ZYBO development board.
    
# 3. Synthesizing and Testing The Core
    + Synthesis
        - The core requires no special constraints to function
        - All necessary code can be found in the hdl/src directory
    + Testing
        - The testbench for the behavioral simulation can be found in hdl/tb
        - Running the test requires two files that contain the test vectors
        - The test vector files can be generated by executing the script reference_implementation/trivium_py.py
        - The test vectors consist of randomly generated input (trivium_ref_in.txt) and corresponding encrypted
          outputs (trivisum_ref_out.txt)
        - Be sure to copy these test vector files to the directory of the project that runs the testbench if you
          are using Xilinx ISE or include them in the project in case of Vivado
        - The testbench is self checking and will abort with a success message if all tests pass
        - Create a simple Zynq design with a single Zynq 7 Processing System core and use the bare-metal 
          test code found in sw/basic_test
    + Linux Integration and Testing
        - Source the Xilinx build environment script: 
          # source /opt/Xilinx/Vivado/2016.2/settings64.sh
        - Set environment variables:
          # export ARCH=arm
          # export CROSS_COMPILE=arm-xilinx-linux-gnueabi-
          # export KDIR=<PATH_TO_KERNEL_TREE>
        - Run 'make' to build the driver
        - Add IP core to your design and map the device to memory
        - Add a node for the AXI core to the device tree and compile new device tree
        - In a running Linux system, insert the driver using 'insmod' or 'modprobe':
          # insmod axi_trivium.ko
        - Run the Python test script found in sw/linux_test on the device (requires 'Python3')
        - The IP core can be interfaced via the driver-managed /proc/axi_trivium entry
		
# 4. TODOs
    + Currently none

# 5. License
    This project is licensed under the Lesser General Public License (LGPL). See the lincense.txt file in the top
    level project directory for more info.

# 6. References
    + [1] http://www.ecrypt.eu.org/stream/p3ciphers/trivium/trivium_p3.pdf
